!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.WebflowSummaryCards=t():e.WebflowSummaryCards=t()}(this,(()=>(function(e,t){"use strict";var a={version:"1.0.1-safe",mainLibraryReady:!1,init:function(){var a=this;console.log("🔄 Summary Cards V2 (Safe Mode) starting...");var n=function(){var r=void 0!==e.WebflowFieldEnhancer,o=t.querySelector('[data-form="multistep"]'),i=t.querySelectorAll('[data-form="step"]').length>0;r&&o&&i?(console.log("✅ Main library and form ready, initializing summary cards..."),a.mainLibraryReady=!0,setTimeout((function(){a.setup()}),1e3)):(console.log("⏳ Waiting... Main:".concat(r," Form:").concat(!!o," Steps:").concat(i)),setTimeout(n,200))};"loading"===t.readyState?t.addEventListener("DOMContentLoaded",(function(){setTimeout(n,1e3)})):setTimeout(n,1e3)},setup:function(){var e=this;console.log("🔄 Initializing Summary Card System (Safe Mode)..."),this.mainLibraryReady?(this.setupSafeEventListeners(),setTimeout((function(){e.populateInitialValues()}),500)):console.warn("❌ Main library not ready, aborting summary setup")},setupSafeEventListeners:function(){var e=this;t.querySelectorAll('[data-form="multistep"]').forEach((function(a){console.log("📋 Setting up SAFE summary listeners for form:",a.id||"unnamed"),t.addEventListener("input",(function(t){a.contains(t.target)&&e.shouldHandleField(t.target)&&requestAnimationFrame((function(){e.handleFieldChange(t.target)}))}),{passive:!0,capture:!1}),t.addEventListener("change",(function(t){a.contains(t.target)&&e.shouldHandleField(t.target)&&requestAnimationFrame((function(){e.handleFieldChange(t.target)}))}),{passive:!0,capture:!1}),t.addEventListener("change",(function(t){a.contains(t.target)&&t.target.matches('[data-step-field-name="sameAsMainContact"]')&&requestAnimationFrame((function(){e.handleSameAsMainContact(t.target)}))}),{passive:!0,capture:!1})}))},shouldHandleField:function(e){var t=e.dataset.stepFieldName||e.dataset.stepField,a=e.matches('\n                [data-form="next-btn"], \n                [data-form="back-btn"], \n                [data-form="submit"],\n                [data-go-to], \n                [data-skip],\n                button,\n                [type="submit"],\n                [type="button"],\n                .w-button\n            '),n=e.closest('[data-form="step"]'),r=n&&("none"===n.style.display||n.classList.contains("w-hidden")||n.hasAttribute("hidden"));return t&&!a&&!r},handleFieldChange:function(e){var t=this;if(this.mainLibraryReady){var a=e.dataset.stepFieldName||e.dataset.stepField;if(a)try{var n=this.getFieldValue(e);if("phone"===a||"countryCode"===a)return void this.handlePhoneFieldUpdate(e,a,n);var r=this.findSummaryElements(e,a);r.length>0&&(r.forEach((function(a){t.updateSummaryDisplay(a,n,e)})),console.log("📊 Updated ".concat(r.length," summary element(s) for: ").concat(a,' = "').concat(n,'"')))}catch(e){console.warn("Summary update error:",e)}}},getFieldValue:function(e){if("radio"===e.type){var a=t.querySelector('input[name="'.concat(e.name,'"]:checked'));return a?a.value:""}if("checkbox"===e.type)return e.checked?e.value||"Yes":"No";if("select"===e.tagName.toLowerCase()){var n=e.options[e.selectedIndex];return n?n.text:""}return e.value||""},handlePhoneFieldUpdate:function(e,t,a){if(this.mainLibraryReady){console.log("📞 Handling phone field update: ".concat(t,' = "').concat(a,'"'));var n=e.closest("[data-step-type]");if(n){var r=n.querySelector('[data-step-field-name="phone"]'),o=n.querySelector('[data-step-field-name="countryCode"]');if(r&&o){var i=this.getFieldValue(r),s=this.getFieldValue(o),l=this.formatInternationalPhone(i,s,o);this.findSummaryElements(r,"phone").forEach((function(e){e.textContent=l,e.classList.add("summary-updated"),setTimeout((function(){e.classList.remove("summary-updated")}),1500)})),console.log('📞 Updated phone summary with: "'.concat(l,'"'))}else console.warn("Could not find both phone and countryCode fields in step")}}},formatInternationalPhone:function(e,t,a){if(!e)return"+1 (xxx) xxx-xxxx";try{var n=this.getCountryIsoFromField(a,t);if(n||(n="US"),"function"==typeof parsePhoneNumber)try{var r=parsePhoneNumber(e,n);if(r&&r.isValid())return r.formatInternational()}catch(e){console.warn("Libphonenumber parsing failed:",e)}return this.fallbackPhoneFormat(e,t)}catch(a){return console.warn("Phone formatting error:",a),this.fallbackPhoneFormat(e,t)}},getCountryIsoFromField:function(e,t){if(!e||!t)return null;var a=e.options[e.selectedIndex];if(!a)return null;if(a.dataset.iso)return a.dataset.iso;var n={"+1":"US","+44":"GB","+33":"FR","+49":"DE","+81":"JP","+86":"CN","+91":"IN","+55":"BR","+61":"AU","+7":"RU"};if(n[t])return n[t];var r=a.text.match(/\(\+(\d+)\)/);return r?n["+".concat(r[1])]:"US"},fallbackPhoneFormat:function(e,t){var a=e.replace(/\D/g,""),n=t||"+1";return n.startsWith("+")||(n="+"+n),"+1"!==n&&"+1 "!==n||10!==a.length?"".concat(n," ").concat(e):"+1 (".concat(a.substr(0,3),") ").concat(a.substr(3,3),"-").concat(a.substr(6,4))},findSummaryElements:function(e,a){var n=[],r=e.closest("[data-step-type]");if(!r)return n;var o=r.dataset.stepType,i=r.dataset.stepNumber||"1",s=r.dataset.stepSubtype,l=t.querySelectorAll('[data-summary-type="'.concat(o,'"][data-summary-number="').concat(i,'"][data-summary-subtype="').concat(s,'"]'));return 0===l.length&&(l=t.querySelectorAll('[data-summary-type="'.concat(o,'"][data-summary-number="').concat(i,'"]'))),0===l.length&&(l=t.querySelectorAll('[data-summary-type="'.concat(o,'"]'))),l.forEach((function(e){var t=e.querySelector('[data-summary-field="'.concat(a,'"]'));t&&n.push(t)})),n},updateSummaryDisplay:function(e,t,a){if(this.mainLibraryReady){var n=t;if("tel"===a.type||"phone"===a.dataset.stepFieldName)n=this.formatPhoneForSummary(t,a);else if("email"===a.type||"email"===a.dataset.stepFieldName)n=t||"email@example.com";else if("countryCode"===a.dataset.stepFieldName){var r;n=(null===(r=a.options[a.selectedIndex])||void 0===r?void 0:r.text)||t}else"checkbox"===a.type&&"sameAsMainContact"!==a.dataset.stepFieldName?n=a.checked?"Yes":"No":"radio"===a.type&&(n=t||"Not selected");var o=n||this.getPlaceholderText(a.dataset.stepFieldName||a.dataset.stepField);e.textContent=o,e.classList.add("summary-updated"),setTimeout((function(){e.classList.remove("summary-updated")}),1500)}},formatPhoneForSummary:function(e,t){if(!e)return"+1 (xxx) xxx-xxxx";var a=t.closest("[data-step-type]"),n=null==a?void 0:a.querySelector('[data-step-field-name="countryCode"]'),r="+1";if(n&&n.value){var o=n.options[n.selectedIndex];o&&"Another option"!==o.value&&(r=o.value)}if(e.length>=10){var i=e.replace(/\D/g,"");if(10===i.length&&("+1"===r||"+1 "===r))return"+1 (".concat(i.substr(0,3),") ").concat(i.substr(3,3),"-").concat(i.substr(6,4))}return"".concat(r," ").concat(e)},handleSameAsMainContact:function(e){if(this.mainLibraryReady&&e.checked){var t=e.closest('[data-step-type="member"]');if(t){var a=this.getMainContactData();Object.keys(a).forEach((function(e){if(["firstName","lastName","email","address","city","state","country","postalCode","phone"].includes(e)){var n=t.querySelector('[data-step-field-name="'.concat(e,'"]'));if(n){n.value=a[e];var r=new Event("input",{bubbles:!0});n.dispatchEvent(r)}}}))}}},getMainContactData:function(){var e=this,a=t.querySelector('[data-step-type="contact"][data-step-subtype="info"]');if(!a)return{};var n={};return a.querySelectorAll("[data-step-field-name], [data-step-field]").forEach((function(t){var a=t.dataset.stepFieldName||t.dataset.stepField;a&&(n[a]=e.getFieldValue(t))})),n},getPlaceholderText:function(e){return{firstName:"First Name",lastName:"Last Name",email:"email@example.com",address:"123 Main St",city:"City",state:"State",country:"Country",postalCode:"12345",phone:"+1 (xxx) xxx-xxxx",companyName1:"Company Name",companyName2:"Company Name 2",companyName3:"Company Name 3",extension:"LLC",entityName:"Entity Name",trustName:"Trust Name",managerName:"Manager Name"}[e]||"Not specified"},populateInitialValues:function(){var e=this;if(this.mainLibraryReady){console.log("📋 Populating initial summary values (safe mode)...");var a=t.querySelectorAll("[data-step-field-name], [data-step-field]"),n=0;a.forEach((function(t){e.shouldHandleField(t)&&(t.value||"radio"===t.type&&t.checked||"checkbox"===t.type&&t.checked)&&(e.handleFieldChange(t),n++)})),console.log("📊 Populated ".concat(n," initial summary values"))}}};console.log("📦 Loading Summary Cards V2 (Safe Mode)"),a.init(),e.WebflowSummaryCardsSafe=a}(window,document),function(e,t){"use strict";var a={version:"1.0.3-fixed",mainLibraryReady:!1,init:function(){console.log("🔄 Summary Cards V4 (Fixed) starting...");var n=function(){var r=void 0!==e.WebflowFieldEnhancer,o=t.querySelector('[data-form="multistep"]'),i=t.querySelectorAll('[data-form="step"]').length>0;r&&o&&i?(console.log("✅ Main library and form ready, initializing V4 summary cards..."),a.mainLibraryReady=!0,setTimeout((function(){a.setup()}),1e3)):(console.log("⏳ Waiting... Main:"+r+" Form:"+!!o+" Steps:"+i),setTimeout(n,200))};"loading"===t.readyState?t.addEventListener("DOMContentLoaded",(function(){setTimeout(n,1e3)})):setTimeout(n,1e3)},setup:function(){var e=this;console.log("🔄 Initializing Summary Card System V4 (Fixed)..."),this.mainLibraryReady?(this.hideAllSummaryCards(),this.clearDummyText(),this.setupFixedEventListeners(),this.setupGooglePlacesMonitoring(),setTimeout((function(){e.updateSummaryVisibility(),e.populateAllValues()}),500)):console.warn("❌ Main library not ready, aborting summary setup")},hideAllSummaryCards:function(){console.log("👁️ Hiding all summary cards initially...");var e=t.querySelectorAll("[data-summary-type]"),a=0;e.forEach((function(e){e.style.display="none",e.classList.add("summary-hidden"),a++})),console.log("👁️ Hidden "+a+" summary containers")},clearDummyText:function(){var e=this;console.log("🧹 Clearing dummy text from summary fields...");var a=t.querySelectorAll("[data-summary-field]"),n=0;a.forEach((function(t){var a=t.getAttribute("data-summary-field"),r=t.textContent.trim();e.isDummyText(r,a)&&(t.textContent=e.getPlaceholderText(a),t.classList.add("summary-placeholder"),n++)})),console.log("🧹 Cleared "+n+" dummy text fields")},isDummyText:function(e,t){return["Your First Name","Your Last Name","Your first name","Your last name","email@email.com","ChrisCorp","ChrisCorp2","ChrisCorp3","123 Park Ave.","Gotham","New York","United States","111111","+1 (111) 111-1111","Your entity name","Your full name","Trust name","Trustee full name","Nevada"].some((function(t){return e.includes(t)}))||e==="Your "+t||e.toLowerCase().includes("dummy")||e.toLowerCase().includes("placeholder")},setupFixedEventListeners:function(){var e=this;t.addEventListener("input",(function(t){e.shouldHandleField(t.target)&&requestAnimationFrame((function(){e.handleFieldChange(t.target)}))}),{passive:!0,capture:!0}),t.addEventListener("change",(function(t){e.shouldHandleField(t.target)&&requestAnimationFrame((function(){e.handleFieldChange(t.target)}))}),{passive:!0,capture:!0}),t.addEventListener("click",(function(t){t.target.matches('[data-form="next-btn"], [data-form="back-btn"], [data-go-to], [data-answer]')&&setTimeout((function(){e.updateSummaryVisibility()}),300)}),{passive:!0}),t.addEventListener("change",(function(t){t.target.matches('[data-step-field-name="sameAsMainContact"]')&&requestAnimationFrame((function(){e.handleSameAsMainContact(t.target)}))}),{passive:!0,capture:!1}),console.log("📋 Set up V4 fixed event listeners")},setupGooglePlacesMonitoring:function(){var e=this,a=t.querySelectorAll('[data-google-places="true"]');a.forEach((function(t){new MutationObserver((function(a){a.forEach((function(a){"attributes"===a.type&&"value"===a.attributeName&&e.handleFieldChange(t)}))})).observe(t,{attributes:!0,attributeFilter:["value"]});var a=t.value;setInterval((function(){t.value!==a&&(a=t.value,e.handleFieldChange(t))}),500)})),console.log("🌍 Set up Google Places monitoring for "+a.length+" fields")},shouldHandleField:function(e){var t=e.dataset.stepFieldName||e.dataset.stepField,a=e.matches('\n                [data-form="next-btn"], \n                [data-form="back-btn"], \n                [data-form="submit"],\n                [data-go-to], \n                [data-skip],\n                button,\n                [type="submit"],\n                [type="button"],\n                .w-button\n            '),n=e.closest('[data-form="step"]'),r=n&&("none"===n.style.display||n.classList.contains("w-hidden")||n.hasAttribute("hidden")),o=!!e.closest('[data-form="multistep"]');return t&&!a&&!r&&o},handleFieldChange:function(e){if(this.mainLibraryReady){var t=e.dataset.stepFieldName||e.dataset.stepField;if(t)try{var a=this.getFieldValue(e);if("phone"===t||"countryCode"===t)return void this.handlePhoneFieldUpdate(e,t,a);if(!a&&"checkbox"!==e.type)return;var n=this.findSummaryElements(e,t);if(n.length>0){var r=this;n.forEach((function(t){r.updateSummaryDisplay(t,a,e)})),console.log("📊 Updated "+n.length+" summary element(s) for: "+t+' = "'+a+'"')}}catch(e){console.warn("Summary update error:",e)}}},getFieldValue:function(e){if("radio"===e.type){var a=t.querySelector('input[name="'+e.name+'"]:checked');return a?a.value:""}if("checkbox"===e.type)return e.checked?e.value||"Yes":"No";if("select"===e.tagName.toLowerCase()){var n=e.options[e.selectedIndex];return n?n.text:""}return e.value||""},handlePhoneFieldUpdate:function(e,t,a){if(this.mainLibraryReady){console.log("📞 Handling phone field update: "+t+' = "'+a+'"');var n=e.closest("[data-step-type]");if(n){var r=n.querySelector('[data-step-field-name="phone"]'),o=n.querySelector('[data-step-field-name="countryCode"]');if(r&&o){var i=this.getFieldValue(r),s=this.getFieldValue(o);if(i&&s&&"Another option"!==s){var l=this.formatInternationalPhone(i,s,o);this.findSummaryElements(r,"phone").forEach((function(e){e.textContent=l,e.classList.remove("summary-placeholder"),e.classList.add("summary-updated"),setTimeout((function(){e.classList.remove("summary-updated")}),1500)})),console.log('📞 Updated phone summary with: "'+l+'"')}}else console.warn("Could not find both phone and countryCode fields in step")}}},formatInternationalPhone:function(e,t,a){if(!e)return"+1 (xxx) xxx-xxxx";try{var n=this.getCountryIsoFromField(a,t);if(n||(n="US"),"function"==typeof parsePhoneNumber)try{var r=parsePhoneNumber(e,n);if(r&&r.isValid())return r.formatInternational()}catch(e){console.warn("Libphonenumber parsing failed:",e)}return this.fallbackPhoneFormat(e,t)}catch(a){return console.warn("Phone formatting error:",a),this.fallbackPhoneFormat(e,t)}},getCountryIsoFromField:function(e,t){if(!e||!t)return null;var a=e.options[e.selectedIndex];if(!a)return null;if(a.dataset.iso)return a.dataset.iso;var n={"+1":"US","+44":"GB","+33":"FR","+49":"DE","+81":"JP","+86":"CN","+91":"IN","+55":"BR","+61":"AU","+7":"RU"};return n[t]?n[t]:"US"},fallbackPhoneFormat:function(e,t){var a=e.replace(/\D/g,""),n=t||"+1";return n.startsWith("+")||(n="+"+n),"+1"!==n&&"+1 "!==n||10!==a.length?n+" "+e:"+1 ("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6,4)},findSummaryElements:function(e,a){var n=[],r=e.closest("[data-step-type]");if(!r)return n;for(var o=r.dataset.stepType,i=r.dataset.stepNumber||"1",s=['[data-summary-type="'+o+'"][data-summary-number="'+i+'"][data-summary-subtype="'+r.dataset.stepSubtype+'"]','[data-summary-type="'+o+'"][data-summary-number="'+i+'"]','[data-summary-type="'+o+'"]'],l=[],u=0;u<s.length&&!((l=t.querySelectorAll(s[u])).length>0);u++);return l.forEach((function(e){var t=e.querySelector('[data-summary-field="'+a+'"]');t&&n.push(t)})),n},updateSummaryVisibility:function(){console.log("📊 Updating summary card visibility..."),t.querySelectorAll("[data-summary-type]").forEach((function(e){e.style.display="none",e.classList.add("summary-hidden"),e.classList.remove("summary-visible")})),this.showCompletedSectionSummaries(),this.showActiveSectionSummaries()},showCompletedSectionSummaries:function(){var e=this;t.querySelectorAll('[data-form="step"]').forEach((function(t,a){"none"!==t.style.display&&!t.classList.contains("w-hidden")||!e.isStepCompleted(t)||t.querySelectorAll("[data-step-type]").forEach((function(t){var a=t.dataset.stepType,n=t.dataset.stepNumber||"1",r=t.dataset.stepSubtype;e.showSummaryCardForSection(a,n,r)}))}))},showActiveSectionSummaries:function(){var e=t.querySelector('[data-form="step"]:not([style*="display: none"])');if(e){var a=this;e.querySelectorAll("[data-step-type]").forEach((function(e){var t=e.querySelectorAll("[data-step-field-name], [data-step-field]"),n=!1;if(t.forEach((function(e){(e.value||"checkbox"===e.type&&e.checked||"radio"===e.type&&e.checked)&&(n=!0)})),n){var r=e.dataset.stepType,o=e.dataset.stepNumber||"1",i=e.dataset.stepSubtype;a.showSummaryCardForSection(r,o,i)}}))}},showSummaryCardForSection:function(e,a,n){for(var r=['[data-summary-type="'+e+'"][data-summary-number="'+a+'"][data-summary-subtype="'+n+'"]','[data-summary-type="'+e+'"][data-summary-number="'+a+'"]','[data-summary-type="'+e+'"]'],o=0;o<r.length;o++){var i=t.querySelectorAll(r[o]);if(i.length>0){i.forEach((function(e){e.style.display="",e.classList.remove("summary-hidden"),e.classList.add("summary-visible")})),console.log("👁️ Showing summary for: "+e+(n?"-"+n:"")+" #"+a);break}}},isStepCompleted:function(e){var t=e.querySelectorAll("[required]"),a=!0;return t.forEach((function(t){t.value||"radio"===t.type&&e.querySelector('input[name="'+t.name+'"]:checked')||(a=!1)})),a},updateSummaryDisplay:function(e,t,a){if(this.mainLibraryReady){var n=t;if("tel"===a.type||"phone"===a.dataset.stepFieldName)n=this.formatPhoneForSummary(t,a);else if("email"===a.type||"email"===a.dataset.stepFieldName)n=t||"email@example.com";else if("countryCode"===a.dataset.stepFieldName){var r=a.options[a.selectedIndex];n=(null==r?void 0:r.text)||t}else"checkbox"===a.type&&"sameAsMainContact"!==a.dataset.stepFieldName?n=a.checked?"Yes":"No":"radio"===a.type&&(n=t||"Not selected");var o=n||this.getPlaceholderText(a.dataset.stepFieldName||a.dataset.stepField);e.textContent=o,e.classList.remove("summary-placeholder"),e.classList.add("summary-updated"),setTimeout((function(){e.classList.remove("summary-updated")}),1500)}},formatPhoneForSummary:function(e,t){if(!e)return"+1 (xxx) xxx-xxxx";var a=t.closest("[data-step-type]"),n=null==a?void 0:a.querySelector('[data-step-field-name="countryCode"]'),r="+1";if(n&&n.value){var o=n.options[n.selectedIndex];o&&"Another option"!==o.value&&(r=o.value)}if(e.length>=10){var i=e.replace(/\D/g,"");if(10===i.length&&("+1"===r||"+1 "===r))return"+1 ("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6,4)}return r+" "+e},handleSameAsMainContact:function(e){if(this.mainLibraryReady&&e.checked){var t=e.closest('[data-step-type="member"]');if(t){var a=this.getMainContactData();Object.keys(a).forEach((function(e){if(["firstName","lastName","email","address","city","state","country","postalCode","phone"].includes(e)){var n=t.querySelector('[data-step-field-name="'+e+'"]');if(n){n.value=a[e];var r=new Event("input",{bubbles:!0});n.dispatchEvent(r)}}}))}}},getMainContactData:function(){var e=t.querySelector('[data-step-type="contact"][data-step-subtype="info"]');if(!e)return{};var a={},n=this;return e.querySelectorAll("[data-step-field-name], [data-step-field]").forEach((function(e){var t=e.dataset.stepFieldName||e.dataset.stepField;t&&(a[t]=n.getFieldValue(e))})),a},getPlaceholderText:function(e){return{firstName:"First Name",lastName:"Last Name",email:"email@example.com",address:"123 Main St",city:"City",state:"State",country:"Country",postalCode:"12345",phone:"+1 (xxx) xxx-xxxx",companyName1:"Company Name",companyName2:"Company Name 2",companyName3:"Company Name 3",extension:"LLC",entityName:"Entity Name",trustName:"Trust Name",managerName:"Manager Name",trustees:"Trustee Names",trustee1:"Trustee Name",trustee2:"Trustee Name",trustee3:"Trustee Name"}[e]||"Not specified"},populateAllValues:function(){if(this.mainLibraryReady){console.log("📋 Populating all current values (V4)...");var e=t.querySelectorAll("[data-step-field-name], [data-step-field]"),a=0,n=this;e.forEach((function(e){n.shouldHandleField(e)&&(e.value||"radio"===e.type&&e.checked||"checkbox"===e.type&&e.checked)&&(setTimeout((function(){n.handleFieldChange(e)}),100*a),a++)})),console.log("📊 Populating "+a+" field values")}}};console.log("📦 Loading Summary Cards V4 (Fixed)"),a.init(),e.WebflowSummaryCardsV4=a}(window,document),{})));