!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.WebflowSummaryCards=t():e.WebflowSummaryCards=t()}(this,(()=>(function(e,t){"use strict";var a={version:"1.0.0",init:function(){var e=this;"loading"===t.readyState?t.addEventListener("DOMContentLoaded",(function(){return e.setup()})):this.setup()},setup:function(){console.log("ðŸ”„ Initializing Summary Card System..."),this.setupEventListeners(),this.populateInitialValues(),this.observeFormChanges()},setupEventListeners:function(){var e=this;t.querySelectorAll('[data-form="multistep"]').forEach((function(t){console.log("ðŸ“‹ Setting up summary listeners for form:",t.id||"unnamed"),t.addEventListener("input",(function(t){e.handleFieldChange(t.target)})),t.addEventListener("change",(function(t){e.handleFieldChange(t.target)})),t.addEventListener("change",(function(t){t.target.matches('[data-step-field-name="sameAsMainContact"]')&&e.handleSameAsMainContact(t.target)}))}))},handleFieldChange:function(e){var t=this,a=e.dataset.stepFieldName||e.dataset.stepField;if(a){var n=this.getFieldValue(e);if("phone"!==a&&"countryCode"!==a){var o=this.findSummaryElements(e,a);o.length>0&&(o.forEach((function(a){t.updateSummaryDisplay(a,n,e)})),console.log("ðŸ“Š Updated ".concat(o.length," summary element(s) for: ").concat(a,' = "').concat(n,'"')))}else this.handlePhoneFieldUpdate(e,a,n)}},handlePhoneFieldUpdate:function(e,t,a){console.log("ðŸ“ž Handling phone field update: ".concat(t,' = "').concat(a,'"'));var n=e.closest("[data-step-type]");if(n){var o=n.querySelector('[data-step-field-name="phone"]'),s=n.querySelector('[data-step-field-name="countryCode"]');if(o&&s){var r=this.getFieldValue(o),i=this.getFieldValue(s),c=this.formatInternationalPhone(r,i,s);this.findSummaryElements(o,"phone").forEach((function(e){e.textContent=c,e.classList.add("summary-updated"),setTimeout((function(){e.classList.remove("summary-updated")}),1500)})),console.log('ðŸ“ž Updated phone summary with: "'.concat(c,'"'))}else console.warn("Could not find both phone and countryCode fields in step")}},formatInternationalPhone:function(e,t,a){if(!e)return"+1 (xxx) xxx-xxxx";try{var n=this.getCountryIsoFromField(a,t);if(n||(n="US"),"function"==typeof parsePhoneNumber){console.log('ðŸ“ž Parsing phone with libphonenumber: "'.concat(e,'" for country "').concat(n,'"'));try{var o=parsePhoneNumber(e,n);if(o&&o.isValid()){var s=o.formatInternational();return console.log('ðŸ“ž Libphonenumber formatted: "'.concat(s,'"')),s}}catch(e){console.warn("Libphonenumber parsing failed:",e)}}return this.fallbackPhoneFormat(e,t)}catch(a){return console.warn("Phone formatting error:",a),this.fallbackPhoneFormat(e,t)}},getCountryIsoFromField:function(e,t){if(!e||!t)return null;var a=e.options[e.selectedIndex];if(!a)return null;if(a.dataset.iso)return a.dataset.iso;var n=a.text,o={"+1":"US","+1 ":"US","+44":"GB","+33":"FR","+49":"DE","+81":"JP","+86":"CN","+91":"IN","+55":"BR","+61":"AU","+7":"RU","+39":"IT","+34":"ES","+31":"NL","+46":"SE","+47":"NO","+45":"DK","+358":"FI","+41":"CH","+43":"AT","+32":"BE","+351":"PT","+30":"GR","+48":"PL","+420":"CZ","+36":"HU","+40":"RO","+359":"BG","+385":"HR","+386":"SI","+421":"SK","+370":"LT","+371":"LV","+372":"EE"};if(o[t])return o[t];var s=n.match(/\(\+(\d+)\)/);return s?o["+".concat(s[1])]:{"united states":"US",usa:"US",america:"US","united kingdom":"GB",uk:"GB","great britain":"GB",england:"GB",france:"FR",germany:"DE",japan:"JP",china:"CN",india:"IN",brazil:"BR",australia:"AU",russia:"RU",italy:"IT",spain:"ES",netherlands:"NL",sweden:"SE",norway:"NO",denmark:"DK",finland:"FI",switzerland:"CH",austria:"AT",belgium:"BE",portugal:"PT",greece:"GR",poland:"PL",canada:"CA"}[n.toLowerCase().split("(")[0].trim()]||null},fallbackPhoneFormat:function(e,t){var a=e.replace(/\D/g,""),n=t||"+1";return n.startsWith("+")||(n="+"+n),"+1"!==n&&"+1 "!==n||10!==a.length?"+44"===n&&a.length>=10?"+44 ".concat(a.substr(0,4)," ").concat(a.substr(4,3)," ").concat(a.substr(7)):"+33"===n&&10===a.length?"+33 ".concat(a.substr(0,1)," ").concat(a.substr(1,2)," ").concat(a.substr(3,2)," ").concat(a.substr(5,2)," ").concat(a.substr(7,2)):"+49"===n&&a.length>=10?"+49 ".concat(a.substr(0,3)," ").concat(a.substr(3,4)," ").concat(a.substr(7)):"".concat(n," ").concat(e):"+1 (".concat(a.substr(0,3),") ").concat(a.substr(3,3),"-").concat(a.substr(6,4))},getFieldValue:function(e){if("radio"===e.type){var a=t.querySelector('input[name="'.concat(e.name,'"]:checked'));return a?a.value:""}if("checkbox"===e.type)return e.checked?e.value||"Yes":"No";if("select"===e.tagName.toLowerCase()){var n=e.options[e.selectedIndex];return n?n.text:""}return e.value||""},findSummaryElements:function(e,a){var n=[],o=e.closest("[data-step-type]");if(!o)return console.warn("Field ".concat(a," not found within a step container")),n;var s=o.dataset.stepType,r=o.dataset.stepNumber||"1",i=o.dataset.stepSubtype,c=[];return 0===(c=t.querySelectorAll('[data-summary-type="'.concat(s,'"][data-summary-number="').concat(r,'"][data-summary-subtype="').concat(i,'"]'))).length&&(c=t.querySelectorAll('[data-summary-type="'.concat(s,'"][data-summary-number="').concat(r,'"]'))),0===c.length&&(c=t.querySelectorAll('[data-summary-type="'.concat(s,'"]'))),c.forEach((function(e){var t=e.querySelector('[data-summary-field="'.concat(a,'"]'));t&&n.push(t)})),n},updateSummaryDisplay:function(e,t,a){var n=t;if("tel"===a.type||"phone"===a.dataset.stepFieldName)n=this.formatPhoneForSummary(t,a);else if("email"===a.type||"email"===a.dataset.stepFieldName)n=t||"email@example.com";else if("countryCode"===a.dataset.stepFieldName){var o;n=(null===(o=a.options[a.selectedIndex])||void 0===o?void 0:o.text)||t}else"checkbox"===a.type&&"sameAsMainContact"!==a.dataset.stepFieldName?n=a.checked?"Yes":"No":"radio"===a.type&&(n=t||"Not selected");var s=n||this.getPlaceholderText(a.dataset.stepFieldName||a.dataset.stepField);e.textContent=s,e.classList.add("summary-updated"),setTimeout((function(){e.classList.remove("summary-updated")}),1500)},formatPhoneForSummary:function(e,t){if(!e)return"+1 (xxx) xxx-xxxx";var a=t.closest("[data-step-type]"),n=null==a?void 0:a.querySelector('[data-step-field-name="countryCode"]'),o="+1";if(n&&n.value){var s=n.options[n.selectedIndex];s&&"Another option"!==s.value&&(o=s.value)}if(e.length>=10){var r=e.replace(/\D/g,"");if(10===r.length&&("+1"===o||"+1 "===o))return"+1 (".concat(r.substr(0,3),") ").concat(r.substr(3,3),"-").concat(r.substr(6,4))}return"".concat(o," ").concat(e)},handleSameAsMainContact:function(e){if(console.log('ðŸ“‹ Handling "same as main contact" checkbox:',e.checked),e.checked){var t=e.closest('[data-step-type="member"]');if(t){var a=this.getMainContactData();console.log("ðŸ“‹ Main contact data:",a),Object.keys(a).forEach((function(e){if(["firstName","lastName","email","address","city","state","country","postalCode","phone"].includes(e)){var n=t.querySelector('[data-step-field-name="'.concat(e,'"]'));if(n){n.value=a[e];var o=new Event("input",{bubbles:!0});n.dispatchEvent(o)}}}))}else console.warn("Same as main contact checkbox not in member container")}},getMainContactData:function(){var e=this,a=t.querySelector('[data-step-type="contact"][data-step-subtype="info"]');if(!a)return console.warn("Main contact container not found"),{};var n={};return a.querySelectorAll("[data-step-field-name], [data-step-field]").forEach((function(t){var a=t.dataset.stepFieldName||t.dataset.stepField;a&&(n[a]=e.getFieldValue(t))})),n},getPlaceholderText:function(e){return{firstName:"First Name",lastName:"Last Name",middleInitial:"M.I.",email:"email@example.com",address:"123 Main St",city:"City",state:"State",country:"Country",postalCode:"12345",phone:"+1 (xxx) xxx-xxxx",companyName1:"Company Name",companyName2:"Company Name 2",companyName3:"Company Name 3",extension:"LLC",entityName:"Entity Name",trustName:"Trust Name",managerName:"Manager Name",trusteeName1:"Trustee Name",trusteeName2:"Trustee Name 2",trusteeName3:"Trustee Name 3",trustees:"Trustee Names",memberType:"Individual",sameAsMainContact:"No",foreignQualification:"No",taxClassification:"Single Member",ownerProfile:"Not Applicable"}[e]||"Not specified"},populateInitialValues:function(){var e=this;console.log("ðŸ“‹ Populating initial summary values...");var a=t.querySelectorAll("[data-step-field-name], [data-step-field]"),n=0;a.forEach((function(t){(t.value||"radio"===t.type&&t.checked||"checkbox"===t.type&&t.checked)&&(e.handleFieldChange(t),n++)})),console.log("ðŸ“Š Populated ".concat(n," initial summary values"))},observeFormChanges:function(){var e=this;new MutationObserver((function(t){t.forEach((function(t){"childList"===t.type&&t.addedNodes.forEach((function(t){if(t.nodeType===Node.ELEMENT_NODE){var a=t.querySelectorAll("[data-step-field-name], [data-step-field]");a.length>0&&(console.log("ðŸ“‹ Detected ".concat(a.length," new form fields, updating summaries")),e.populateInitialValues())}}))}))})).observe(t.body,{childList:!0,subtree:!0})},updateAllSummaries:function(){console.log("ðŸ”„ Manually updating all summaries..."),this.populateInitialValues()},debugMappings:function(){var e=this;console.log("ðŸ” Current field-summary mappings:"),t.querySelectorAll("[data-step-field-name], [data-step-field]").forEach((function(t){var a=t.dataset.stepFieldName||t.dataset.stepField,n=e.findSummaryElements(t,a);console.log("Field: ".concat(a," (").concat(t.id,") -> ").concat(n.length," summary element(s)")),n.forEach((function(e){var t;console.log("  - Summary: ".concat(e.textContent," (in ").concat(null===(t=e.closest("[data-summary-type]"))||void 0===t?void 0:t.dataset.summaryType,")"))}))}))}};a.init(),e.WebflowSummaryCards=a;var n=t.createElement("style");n.textContent="\n        .summary-updated {\n            background-color: #e8f5e8 !important;\n            transition: background-color 0.3s ease;\n        }\n        \n        .multi-form_summary-field-text {\n            transition: background-color 0.3s ease;\n        }\n    ",t.head.appendChild(n)}(window,document),{})));