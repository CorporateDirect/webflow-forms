!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("libphonenumber-js")):"function"==typeof define&&define.amd?define(["libphonenumber-js"],t):"object"==typeof exports?exports.WebflowForms=t(require("libphonenumber-js")):e.WebflowForms=t(e["libphonenumber-js"])}(this,(e=>(()=>{"use strict";var t={457:(e,t,n)=>{n.r(t),n.d(t,{default:()=>a});var o=n(860);e=n.hmd(e);const r={version:"1.2.0",config:{autoInit:!0,enhancedClass:"wf-field-enhanced",focusClass:"wf-field-focus",typingClass:"wf-field-typing",branchingEnabled:!0},countryDataCache:null,phoneFormatCache:new Map,branchingState:{currentStep:null,stepHistory:[],conditionalSteps:new Map,branchingRules:new Map},clearCaches:function(){this.countryDataCache=null,this.phoneFormatCache.clear(),this.branchingState.conditionalSteps.clear(),this.branchingState.branchingRules.clear(),this.branchingState.stepHistory=[]},initBranchingLogic:function(){console.log("Initializing modular branching logic...");try{const e=document.querySelector('[data-form="multistep"]');if(!e)return void console.warn("No multistep form found");this.mapFormSteps(e),this.setupBranchingListeners(e),this.initializeStepVisibility(e),console.log("Branching logic initialized successfully")}catch(e){console.error("Error initializing branching logic:",e)}},mapFormSteps:function(e){console.log("Mapping form steps and conditions..."),e.querySelectorAll('[data-form="step"]').forEach(((e,t)=>{const n=e.querySelector("[data-go-to], [data-answer]");if(!n)return;const o=this.getStepId(e,t),r=n.dataset.goTo,a=n.dataset.answer;this.branchingState.conditionalSteps.set(o,{element:e,wrapper:n,goTo:r,answer:a,index:t,isVisible:0===t}),console.log(`Mapped step: ${o}`,{goTo:r,answer:a})})),this.mapBranchingInputs(e)},mapBranchingInputs:function(e){e.querySelectorAll("[data-go-to]").forEach((e=>{const t=e.dataset.goTo,n=e.value||e.dataset.value,o=e.type||e.tagName.toLowerCase(),r={element:e,goTo:t,value:n,inputType:o,isRadio:"radio"===o,isSelect:"select"===o},a=this.findBranchingContainer(e),i=a.dataset.branchingGroup||this.generateContainerId(a);this.branchingState.branchingRules.has(i)||this.branchingState.branchingRules.set(i,[]),this.branchingState.branchingRules.get(i).push(r),console.log(`Mapped branching input: ${i} -> ${t}`)}))},findBranchingContainer:function(e){let t=e.closest("[data-branching-group]");return t||(t=e.closest(".radio_component"),t||(t=e.closest(".multi-form_option-container"),t||e.closest('[data-form="step"]')||e.parentElement))},generateContainerId:function(e){const t=e.closest('[data-form="step"]');return`branching-${Array.from(t.parentElement.children).indexOf(t)}-${Array.from(t.querySelectorAll(".radio_component, .multi-form_option-container")).indexOf(e)}`},getStepId:function(e,t){const n=e.querySelector("[data-go-to], [data-answer]");return n?.dataset.answer||n?.dataset.goTo||`step-${t}`},setupBranchingListeners:function(e){console.log("Setting up branching listeners..."),e.addEventListener("change",(e=>{this.handleBranchingChange(e)})),e.addEventListener("click",(e=>{"radio"===e.target.type&&e.target.dataset.goTo&&this.handleBranchingChange(e)})),e.addEventListener("click",(e=>{"next-btn"===e.target.dataset.form?this.handleNextStep(e):"back-btn"===e.target.dataset.form&&this.handleBackStep(e)}))},handleBranchingChange:function(e){const t=e.target,n=t.dataset.goTo;if(!n)return;console.log(`Branching change detected: ${t.value} -> ${n}`);const o=t.closest('[data-form="step"]');o.querySelectorAll("[data-answer]").forEach((e=>{this.hideStepItem(e)}));const r=o.querySelector(`[data-answer="${n}"]`);r&&this.showStepItem(r),this.triggerCustomEvent(t,"branchingChange",{from:t.value,to:n,input:t})},handleNextStep:function(e){e.preventDefault();const t=e.target.closest('[data-form="step"]'),n=this.determineNextStep(t);n&&this.navigateToStep(n,"forward")},handleBackStep:function(e){if(e.preventDefault(),this.branchingState.stepHistory.length>0){const e=this.branchingState.stepHistory.pop();this.navigateToStep(e,"back")}},determineNextStep:function(e){const t=e.querySelector('input[type="radio"]:checked[data-go-to]');if(t)return t.dataset.goTo;const n=e.querySelector('.step_item:not([style*="display: none"])');if(n)return n.dataset.goTo;const o=e.querySelector("[data-go-to]");return o?.dataset.goTo},navigateToStep:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"forward";console.log(`Navigating to step: ${e} (${t})`),this.branchingState.currentStep&&(this.hideStep(this.branchingState.currentStep),"forward"===t&&this.branchingState.stepHistory.push(this.getCurrentStepId()));const n=this.findStepByAnswer(e)||this.findStepByGoTo(e);n&&(this.showStep(n),this.branchingState.currentStep=n,this.triggerCustomEvent(n,"stepNavigation",{stepId:e,direction:t,step:n}))},findStepByAnswer:function(e){return document.querySelector(`[data-form="step"] [data-answer="${e}"]`)?.closest('[data-form="step"]')},findStepByGoTo:function(e){return document.querySelector(`[data-form="step"] [data-go-to="${e}"]`)?.closest('[data-form="step"]')},getCurrentStepId:function(){if(!this.branchingState.currentStep)return null;const e=this.branchingState.currentStep.querySelector("[data-answer], [data-go-to]");return e?.dataset.answer||e?.dataset.goTo},initializeStepVisibility:function(e){e.querySelectorAll('[data-form="step"]').forEach(((e,t)=>{0===t?(this.showStep(e),this.branchingState.currentStep=e):this.hideStep(e),e.querySelectorAll(".step_item").forEach((e=>this.hideStepItem(e)))}))},showStep:function(e){e.style.display="flex",e.classList.add("active-step"),console.log("Showing step:",this.getStepId(e))},hideStep:function(e){e.style.display="none",e.classList.remove("active-step"),console.log("Hiding step:",this.getStepId(e))},showStepItem:function(e){e.style.display="block",e.classList.add("active-step-item")},hideStepItem:function(e){e.style.display="none",e.classList.remove("active-step-item")},resetBranchingState:function(){this.branchingState.currentStep=null,this.branchingState.stepHistory=[];const e=document.querySelector('[data-form="multistep"]');e&&this.initializeStepVisibility(e)},getBranchingAnalytics:function(){return{currentStep:this.getCurrentStepId(),stepHistory:[...this.branchingState.stepHistory],totalSteps:this.branchingState.conditionalSteps.size,totalBranchingRules:Array.from(this.branchingState.branchingRules.values()).flat().length}},validateCurrentStep:function(){if(!this.branchingState.currentStep)return!1;const e=this.branchingState.currentStep.querySelectorAll("input[required], select[required], textarea[required]");for(const t of e)if(!t.value.trim())return console.log("Validation failed for field:",t.name||t.id),!1;return!0},getCountryFlag:function(e){return e&&2===e.length?e.toUpperCase().replace(/./g,(e=>String.fromCodePoint(e.charCodeAt(0)+127397))):""},getCountryCodes:function(){if(this.countryDataCache)return this.countryDataCache;try{const e=(0,o.getCountries)(),t=[],n={US:"United States",GB:"United Kingdom",CA:"Canada",AU:"Australia",DE:"Germany",FR:"France",IT:"Italy",ES:"Spain",NL:"Netherlands",BE:"Belgium",CH:"Switzerland",AT:"Austria",SE:"Sweden",NO:"Norway",DK:"Denmark",FI:"Finland",IE:"Ireland",PT:"Portugal",GR:"Greece",PL:"Poland",CZ:"Czech Republic",HU:"Hungary",JP:"Japan",KR:"South Korea",CN:"China",IN:"India",BR:"Brazil",MX:"Mexico",RU:"Russia",ZA:"South Africa",EG:"Egypt",NG:"Nigeria",IL:"Israel",AE:"United Arab Emirates",SA:"Saudi Arabia",TR:"Turkey",NZ:"New Zealand"};for(const r of e)try{const e=(0,o.getCountryCallingCode)(r);t.push({name:n[r]||r,countryCode:`+${e}`,isoCode:r,flag:this.getCountryFlag(r)})}catch(e){console.warn(`Country ${r} caused an error and was skipped:`,e);continue}return t.sort(((e,t)=>"US"===e.isoCode?-1:"US"===t.isoCode?1:e.name.localeCompare(t.name))),this.countryDataCache=t,t}catch(e){return console.error("Could not generate country data from libphonenumber:",e),[{name:"United States",countryCode:"+1",isoCode:"US",flag:this.getCountryFlag("US")},{name:"United Kingdom",countryCode:"+44",isoCode:"GB",flag:this.getCountryFlag("GB")}]}},setupCountryCodeSelect:function(e){if(console.log("Setting up country code select for:",e.id||e.name),e&&"SELECT"===e.tagName)try{"false"!==e.dataset.countrySearchable?this.createSearchableCountrySelect(e):this.createStandardCountrySelect(e)}catch(t){console.error("Error setting up country code select:",t),this.createStandardCountrySelect(e)}else console.error("Invalid field passed to setupCountryCodeSelect:",e)},createStandardCountrySelect:function(e){console.log("Creating standard country select");try{const t=e.querySelectorAll("option")[0];e.innerHTML="",t&&(""===t.value||""===t.textContent.trim()||t.hasAttribute("disabled")||t.hasAttribute("selected"))&&e.appendChild(t),this.populateCountryOptions(e),console.log(`Standard country select created with ${e.options.length} options`)}catch(e){console.error("Error creating standard country select:",e)}},createSearchableCountrySelect:function(e){console.log("Creating searchable country select");try{const t=e.name,n=e.id,o=e.className,r=e.required,a=this.getPlaceholderText(e),i=this.createDropdownContainer(),s=this.createSearchInput(o,a,n),c=this.createHiddenSelect(t,n,r),l=this.createDropdownList();e.parentNode.insertBefore(i,e),i.appendChild(s),i.appendChild(c),i.appendChild(l);const d=this.getFormattedCountries(e);this.populateSearchableDropdown(l,c,d),this.attachSearchableEvents(s,l,c,d,e),e.remove(),this.triggerCustomEvent(s,"countryCodeSetup",{searchable:!0,countriesCount:d.length}),console.log(`Searchable country select created with ${d.length} countries`)}catch(t){console.error("Error creating searchable country select:",t),this.createStandardCountrySelect(e)}},getPlaceholderText:function(e){const t=e.querySelector("option[disabled]");return t?.textContent||e.placeholder||"Select or search for a country..."},createDropdownContainer:function(){const e=document.createElement("div");return e.dataset.countrySelectContainer="true",e.style.position="relative",e},createSearchInput:function(e,t,n){const o=document.createElement("input");return o.type="text",o.className=e,o.placeholder=t,o.autocomplete="off",o.dataset.countrySearch="true",n&&(o.id=n+"_search"),o},createHiddenSelect:function(e,t,n){const o=document.createElement("select");o.name=e,o.required=n,o.style.display="none",t&&(o.id=t);const r=document.createElement("option");return r.value="",o.appendChild(r),o},createDropdownList:function(){const e=document.createElement("div");return e.dataset.countryDropdown="true",e.style.cssText="\n            position: absolute;\n            top: 100%;\n            left: 0;\n            right: 0;\n            width: 100%;\n            background: white;\n            border: 1px solid #ccc;\n            border-top: none;\n            max-height: 200px;\n            overflow-y: auto;\n            z-index: 1000;\n            display: none;\n            box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n            box-sizing: border-box;\n        ",e},getFormattedCountries:function(e){const t=this.getCountryCodes(),n=e.dataset.countryFormat||"flag-code",o=e.dataset.countryValue||"code";return t.map((e=>{let t=this.formatCountryDisplay(e,n),r=this.formatCountryValue(e,o);return{...e,displayText:t,value:r,searchText:`${e.name} ${e.countryCode}`.toLowerCase()}}))},formatCountryDisplay:function(e,t){switch(t){case"name":return e.name;case"code":return e.countryCode;case"name-code":return`${e.name} (${e.countryCode})`;case"flag-name-code":return`${e.flag} ${e.name} (${e.countryCode})`;default:return`${e.flag} ${e.countryCode}`}},formatCountryValue:function(e,t){switch(t){case"name":return e.name;case"full":return`${e.name} (${e.countryCode})`;default:return e.countryCode}},populateCountryOptions:function(e){try{const t=this.getFormattedCountries(e);t.forEach((t=>{const n=document.createElement("option");n.value=t.value,n.textContent=t.displayText,n.dataset.countryName=t.name,n.dataset.countryCode=t.countryCode,n.dataset.countryFlag=t.flag,e.appendChild(n)})),this.triggerCustomEvent(e,"countryCodeSetup",{searchable:!1,countriesCount:t.length})}catch(e){console.error("Error populating country options:",e)}},populateSearchableDropdown:function(e,t,n){try{e.innerHTML="",n.forEach((n=>{const o=this.createDropdownOption(n);e.appendChild(o);const r=this.createSelectOption(n);t.appendChild(r)}))}catch(e){console.error("Error populating searchable dropdown:",e)}},createDropdownOption:function(e){const t=document.createElement("div");return t.dataset.countryOption="true",t.textContent=e.displayText,t.dataset.value=e.value,t.dataset.countryName=e.name,t.dataset.countryCode=e.countryCode,t.dataset.countryFlag=e.flag,t.style.cssText="\n            padding: 8px 12px;\n            cursor: pointer;\n            border-bottom: 1px solid #eee;\n        ",t.addEventListener("mouseenter",(()=>{t.style.backgroundColor="#f5f5f5"})),t.addEventListener("mouseleave",(()=>{t.style.backgroundColor=""})),t},createSelectOption:function(e){const t=document.createElement("option");return t.value=e.value,t.textContent=e.displayText,t.dataset.countryName=e.name,t.dataset.countryCode=e.countryCode,t.dataset.countryFlag=e.flag,t},triggerCustomEvent:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{const o=new CustomEvent(`webflowField:${t}`,{bubbles:!0,detail:{...n,field:e}});e.dispatchEvent(o)}catch(e){console.warn("Error triggering custom event:",t,e)}},init:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.config=Object.assign({},this.config,e),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",(()=>{this.setupFields(),this.config.branchingEnabled&&this.initBranchingLogic()})):(this.setupFields(),this.config.branchingEnabled&&this.initBranchingLogic())},setupFields:function(){try{const e=document.querySelectorAll("form[data-name] input, form[data-name] textarea, form[data-name] select");e.forEach((e=>{"true"===e.dataset.countryCode&&"SELECT"===e.tagName&&this.setupCountryCodeSelect(e)})),console.log(`WebflowForms initialized - processed ${e.length} fields`)}catch(e){console.error("Error setting up fields:",e)}}};r.config.autoInit&&r.init(),"undefined"!=typeof window&&(window.WebflowFieldEnhancer=r,window.WebflowForms=r),e.exports&&(e.exports=r);const a=r},860:t=>{t.exports=e}},n={};function o(e){var r=n[e];if(void 0!==r)return r.exports;var a=n[e]={id:e,loaded:!1,exports:{}};return t[e](a,a.exports,o),a.loaded=!0,a.exports}return o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o(457)})()));